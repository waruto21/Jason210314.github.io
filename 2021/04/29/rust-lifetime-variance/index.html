<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Rustç”Ÿå‘½å‘¨æœŸä¸å˜å½¢ - OneStep</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="OneStep"><meta name="msapplication-TileImage" content="/images/favicon.jpeg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="OneStep"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="æœ€è¿‘å¯¹ rust çš„ç”Ÿå‘½å‘¨æœŸæœ‰ä¸€äº›ç–‘æƒ‘ï¼Œåœ¨æ‰¾èµ„æ–™å­¦ä¹ çš„è¿‡ç¨‹ä¸­è‡ªç„¶å°±äº†è§£åˆ°ç”± rust ç”Ÿå‘½å‘¨æœŸå¯¼å‡ºçš„ rust subtypeã€variance çš„æ¦‚å¿µï¼Œå¯¹è¿™ä¸€å—å„¿çš„å­¦ä¹ ä¹Ÿè§£ç­”äº†æˆ‘ä¸€äº›å¯¹å…¶ä»–è¯­è¨€çš„é—®é¢˜,åŒæ—¶æˆ‘ä¹Ÿè¢«è®¤è¯†çš„å¤§ä½¬èµ¶é¸­å­ä¸Šæ¶,åœ¨ BUPT Rust Meetup åšäº†åˆ†äº«,keynote è®²ç¨¿åœ¨æ­¤ã€‚"><meta property="og:type" content="blog"><meta property="og:title" content="Rustç”Ÿå‘½å‘¨æœŸä¸å˜å½¢"><meta property="og:url" content="https://wmc1999.top/2021/04/29/rust-lifetime-variance/"><meta property="og:site_name" content="OneStep"><meta property="og:description" content="æœ€è¿‘å¯¹ rust çš„ç”Ÿå‘½å‘¨æœŸæœ‰ä¸€äº›ç–‘æƒ‘ï¼Œåœ¨æ‰¾èµ„æ–™å­¦ä¹ çš„è¿‡ç¨‹ä¸­è‡ªç„¶å°±äº†è§£åˆ°ç”± rust ç”Ÿå‘½å‘¨æœŸå¯¼å‡ºçš„ rust subtypeã€variance çš„æ¦‚å¿µï¼Œå¯¹è¿™ä¸€å—å„¿çš„å­¦ä¹ ä¹Ÿè§£ç­”äº†æˆ‘ä¸€äº›å¯¹å…¶ä»–è¯­è¨€çš„é—®é¢˜,åŒæ—¶æˆ‘ä¹Ÿè¢«è®¤è¯†çš„å¤§ä½¬èµ¶é¸­å­ä¸Šæ¶,åœ¨ BUPT Rust Meetup åšäº†åˆ†äº«,keynote è®²ç¨¿åœ¨æ­¤ã€‚"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://wmc1999.top/2021/04/29/rust-lifetime-variance/image-20210408013314451.png"><meta property="og:image" content="https://wmc1999.top/2021/04/29/rust-lifetime-variance/image-20210408014252451.png"><meta property="og:image" content="https://wmc1999.top/2021/04/29/rust-lifetime-variance/image-20210428235350226.png"><meta property="article:published_time" content="2021-04-29T02:16:32.000Z"><meta property="article:modified_time" content="2021-12-22T15:35:06.596Z"><meta property="article:author" content="Naruto210"><meta property="article:tag" content="rust"><meta property="article:tag" content="variance"><meta property="article:tag" content="subtype"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="image-20210408013314451.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://wmc1999.top/2021/04/29/rust-lifetime-variance/"},"headline":"OneStep","image":["https://wmc1999.top/2021/04/29/rust-lifetime-variance/image-20210408013314451.png","https://wmc1999.top/2021/04/29/rust-lifetime-variance/image-20210408014252451.png","https://wmc1999.top/2021/04/29/rust-lifetime-variance/image-20210428235350226.png"],"datePublished":"2021-04-29T02:16:32.000Z","dateModified":"2021-12-22T15:35:06.596Z","author":{"@type":"Person","name":"Naruto210"},"description":"æœ€è¿‘å¯¹ rust çš„ç”Ÿå‘½å‘¨æœŸæœ‰ä¸€äº›ç–‘æƒ‘ï¼Œåœ¨æ‰¾èµ„æ–™å­¦ä¹ çš„è¿‡ç¨‹ä¸­è‡ªç„¶å°±äº†è§£åˆ°ç”± rust ç”Ÿå‘½å‘¨æœŸå¯¼å‡ºçš„ rust subtypeã€variance çš„æ¦‚å¿µï¼Œå¯¹è¿™ä¸€å—å„¿çš„å­¦ä¹ ä¹Ÿè§£ç­”äº†æˆ‘ä¸€äº›å¯¹å…¶ä»–è¯­è¨€çš„é—®é¢˜,åŒæ—¶æˆ‘ä¹Ÿè¢«è®¤è¯†çš„å¤§ä½¬èµ¶é¸­å­ä¸Šæ¶,åœ¨ BUPT Rust Meetup åšäº†åˆ†äº«,keynote è®²ç¨¿åœ¨æ­¤ã€‚"}</script><link rel="canonical" href="https://wmc1999.top/2021/04/29/rust-lifetime-variance/"><link rel="icon" href="/images/favicon.jpeg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?7b96e333da18981129974d1deaa17ff8";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-164518488-1" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-164518488-1');</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/rss.xml" title="OneStep" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/logo.jpeg" alt="OneStep" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-04-29T02:16:32.000Z" title="4/29/2021, 2:16:32 AM">2021-04-29</time>å‘è¡¨</span><span class="level-item"><time dateTime="2021-12-22T15:35:06.596Z" title="12/22/2021, 3:35:06 PM">2021-12-22</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/rust/">rust</a></span><span class="level-item">16 åˆ†é’Ÿè¯»å®Œ (å¤§çº¦2391ä¸ªå­—)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>æ¬¡è®¿é—®</span></div></div><h1 class="title is-3 is-size-4-mobile">Rustç”Ÿå‘½å‘¨æœŸä¸å˜å½¢</h1><div class="content"><p>æœ€è¿‘å¯¹ rust çš„ç”Ÿå‘½å‘¨æœŸæœ‰ä¸€äº›ç–‘æƒ‘ï¼Œåœ¨æ‰¾èµ„æ–™å­¦ä¹ çš„è¿‡ç¨‹ä¸­è‡ªç„¶å°±äº†è§£åˆ°ç”± rust ç”Ÿå‘½å‘¨æœŸå¯¼å‡ºçš„ rust subtypeã€variance çš„æ¦‚å¿µï¼Œå¯¹è¿™ä¸€å—å„¿çš„å­¦ä¹ ä¹Ÿè§£ç­”äº†æˆ‘ä¸€äº›å¯¹å…¶ä»–è¯­è¨€çš„é—®é¢˜,åŒæ—¶æˆ‘ä¹Ÿè¢«è®¤è¯†çš„å¤§ä½¬èµ¶é¸­å­ä¸Šæ¶,åœ¨ BUPT Rust Meetup åšäº†åˆ†äº«,<a target="_blank" rel="noopener" href="https://github.com/waruto210/waruto210.github.io/blob/hexo/source/_posts/rust-lifetime-variance/variance_rust.key">keynote è®²ç¨¿åœ¨æ­¤</a>ã€‚</p>
<span id="more"></span>

<h1 id="å­ç±»å‹ä¸å˜å½¢"><a href="#å­ç±»å‹ä¸å˜å½¢" class="headerlink" title="å­ç±»å‹ä¸å˜å½¢"></a>å­ç±»å‹ä¸å˜å½¢</h1><p>å­ç±»å‹æ˜¯ç¨‹åºè¯­è¨€ç±»å‹ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼ŒWikipedia å¯¹å…¶æœ‰å¦‚ä¸‹è§£é‡Šï¼š</p>
<blockquote>
<p>If S is a subtype of T, the subtyping relation is often written S &lt;: T, to mean that any term of type S can be safely used in a context where a term of type T is expected.</p>
</blockquote>
<p>è®¸å¤šè¯­è¨€çš„ç±»å‹ç³»ç»Ÿéƒ½æ”¯æŒå­ç±»å‹ï¼Œæœ€ç›´æ¥ã€æœ€ç†Ÿæ‚‰çš„åº”å½“å°±æ˜¯é¢å‘å¯¹è±¡ä¸­ç»§æ‰¿å…³ç³»å½¢æˆçš„å­ç±»å‹ã€‚ä¾‹å¦‚<code>Cat</code>ç±»ç»§æ‰¿äº†<code>Animal</code>ç±»ï¼Œé‚£ä¹ˆ<code>Cat</code>æ˜¯<code>Animal</code>çš„å­ç±»å‹ï¼ˆ<code>Cat &lt;: Animal</code>ï¼‰ï¼Œç›´è§‰ä¸Šå¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œä»»ä½•éœ€è¦<code>Animal</code>çš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨<code>Cat</code>å»æ›¿æ¢ï¼Œè¿™ä¹Ÿæ˜¯é‡Œæ°æ›¿æ¢åŸåˆ™(Liskov substitution principle)ï¼š</p>
<blockquote>
<p>Let $q(x)$ be a property provable about $x$ of type T. Then $q(y)$ should be true for objects $y$ of type $S$ where $S$ is a subtype of T.</p>
</blockquote>
<p>ç»§æ‰¿å…³ç³»å¾ˆç›´æ¥å¯¼å‡ºäº†ä¸¤ä¸ªå…·ä½“ç±»å‹çš„ä¹‹é—´çš„å­ç±»å‹å…³ç³»ï¼Œå¯ç”±ç±»å‹æ„é€ å™¨äº§ç”Ÿçš„ä¸€äº›æ›´å¤æ‚çš„ç±»å‹ä¹‹é—´çš„å­ç±»å‹å…³ç³»å¦‚ä½•ç¡®å®šå‘¢ï¼Ÿ</p>
<p><code>F(T)</code>ä¸ºç±»å‹æ„é€ å™¨ï¼Œ<code>S &lt;: T</code>ï¼Œ é‚£ä¹ˆ<code>F(S)</code>å’Œ<code>F(T)</code>çš„æœ‰æ²¡æœ‰å­ç±»å‹å…³ç³»å‘¢?å¦‚æœæœ‰ï¼Œè°æ˜¯è°çš„å­ç±»å‹å‘¢ï¼Ÿå¤æ‚ç±»å‹ä¹‹é—´çš„å­ç±»å‹å…³ç³»å–å†³äºç±»å‹æ„é€ å™¨ï¼Œç›¸å¯¹äºåŸå§‹ç±»å‹ï¼Œå¯èƒ½æ˜¯ä¿æŒã€åè½¬æˆ–è€…æ— å…³ã€‚</p>
<ul>
<li>å¦‚æœæ˜¯æ˜¯ä¿æŒï¼Œå³<code>F(S) &lt;: F(T)</code>ï¼Œåˆ™ç§°ä¹‹ä¸ºåå˜(<code>covariant</code>)</li>
<li>å¦‚æœæ˜¯åè½¬ï¼Œå³<code>F(T) &lt;: F(S)</code>ï¼Œåˆ™ç§°ä¹‹ä¸ºé€†å˜(<code>contravariant</code>)</li>
<li>å¦‚æœæ˜¯æ— å…³ï¼Œåˆ™ç§°ä¹‹ä¸ºä¸å˜/æŠ—å˜(<code>invariant</code>)</li>
</ul>
<p><code>covariant</code>ã€<code>contravariant</code>çš„æ¦‚å¿µæ¥è‡ªäºèŒƒç•´è®º(<code>Category Theory</code>)ä¸­çš„å‡½å­(<code>Functor</code>)ã€‚</p>
<h1 id="å˜å½¢ä¸ç±»å‹å®‰å…¨"><a href="#å˜å½¢ä¸ç±»å‹å®‰å…¨" class="headerlink" title="å˜å½¢ä¸ç±»å‹å®‰å…¨"></a>å˜å½¢ä¸ç±»å‹å®‰å…¨</h1><p>åœ¨ä¸‹é¢çš„ Java ä»£ç ä¸­ï¼Œ<code>Cat[]</code>èµ‹å€¼ç»™<code>Animal[]</code>ç±»å‹çš„å˜é‡å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯<code>ArrayList&lt;Cat&gt;</code>èµ‹å€¼ç»™<code>ArrayList&lt;Animal&gt;</code>ç±»å‹çš„å˜é‡åˆ™æ— æ³•é€šè¿‡ç¼–è¯‘ã€‚è¯´æ˜ Java åœ¨ç¼–è¯‘æ—¶å¯¹æ•°ç»„é‡‡ç”¨äº†åå˜ï¼Œè€Œå¯¹æ³›å‹å®¹å™¨é‡‡ç”¨äº†æŠ—å˜ã€‚ä½†æ˜¯åœ¨è¿è¡Œæ—¶ï¼Œå¯¹æ•°ç»„å…ƒç´ è¿›è¡Œé”™è¯¯çš„èµ‹å€¼ï¼Œä¼šæŠ›å‡ºè¿è¡Œæ—¶é”™è¯¯ï¼Œè¿™å®é™…æ˜¯ä¸€ç§å¯¹äºç¼–è¯‘æœŸæ•°ç»„åå˜çš„è¡¥æ•‘ï¼Œæ•°ç»„é‡‡ç”¨åå˜æœ¬èº«æ˜¯ä¸€ç§å¾ˆå·®åŠ²çš„è®¾è®¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Cat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">meow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;meow&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Dog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bark</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;bark&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">  <span class="comment">// covariant, ok</span></span><br><span class="line">  Animal[] animals = <span class="keyword">new</span> Animal[<span class="number">10</span>];</span><br><span class="line">  animals = <span class="keyword">new</span> Cat[<span class="number">10</span>];</span><br><span class="line">  <span class="comment">// runtime error</span></span><br><span class="line">  animals[<span class="number">0</span>] = <span class="keyword">new</span> Dog();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// invariant, compile error</span></span><br><span class="line">  List&lt;Animal&gt; listAnimals = <span class="keyword">new</span> ArrayList&lt;Animal&gt;();</span><br><span class="line">  listAnimals = <span class="keyword">new</span> ArrayList&lt;Cat&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”±æ­¤å¯è§ï¼Œå¯¹äºæ”¯æŒå­ç±»å‹çš„è¯­è¨€ï¼Œå˜å½¢çš„è®¾è®¡æ˜¯éå¸¸é‡è¦ï¼Œå…¶ä¼šå½±å“ç¨‹åºçš„ç±»å‹å®‰å…¨ã€‚</p>
<p>é‚£ä¹ˆï¼Œä»€ä¹ˆæ—¶å€™é‡‡ç”¨åå˜ï¼Œä»€ä¹ˆæ—¶å€™é‡‡ç”¨é€†å˜ï¼Œåˆåœ¨ä»€ä¹ˆæ—¶å€™é‡‡ç”¨æŠ—å˜å‘¢ï¼Ÿ</p>
<p>æƒ³ä¸€ä¸‹è¿™æ ·ä¸€ä¸ªç¨‹åºï¼Œä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªç¬¼å­å‚æ•°ï¼Œç¬¼å­é‡Œé¢è£…ç€åŠ¨ç‰©ï¼Œä¸ç®¡ä¼ é€’çš„ç¬¼å­å‚æ•°ä¸­è£…ç€ä»€ä¹ˆåŠ¨ç‰©ï¼Œéƒ½å°†ç¬¼å­ä¸­çš„åŠ¨ç‰©æ›¿æ¢æˆä¸€åªç‹—ï¼Œè¿™æ ·åšçš„è¯ï¼Œå½“è°ƒç”¨å®Œå‡½æ•°åï¼Œå¤–éƒ¨ç¨‹åºç»§ç»­å°†ç¬¼å­ä¸­çš„åŠ¨ç‰©å½“ä½œåŸåŠ¨ç‰©æ¥å¯¹å¾…ï¼Œç±»å‹å®‰å…¨å°±å®Œè›‹äº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Cage</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Animal</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> T inner;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Cage</span><span class="params">(T a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.inner = a;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">evil_feed</span><span class="params">(Cage&lt;Animal&gt; cage)</span> </span>&#123;</span><br><span class="line">  cage.inner = <span class="keyword">new</span> Dog();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">  Cage&lt;Cat&gt; cage = <span class="keyword">new</span> Cage&lt;Cat&gt;(<span class="keyword">new</span> Cat());</span><br><span class="line">  evil_feed(cage);</span><br><span class="line">  cage.inner.meow();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„è¿™æ®µ Java ä»£ç å½“ç„¶æ˜¯æ— æ³•ç¼–è¯‘æˆåŠŸçš„ï¼Œå› ä¸º Java ä¸å¯¹æ³›å‹å®¹å™¨ä½¿ç”¨åå˜ã€‚ä½†æ˜¯ä¸èƒ½ä½¿ç”¨åå˜çš„ä¾æ®æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯<strong>è¯»å†™</strong>æ“ä½œã€‚</p>
<p>å¦‚æœä¸€ä¸ªå®¹å™¨<strong>åªè¯»</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åå˜ï¼Œå°†ä¸€ä¸ª<code>Cage&lt;Cat&gt;</code>å½“ä½œ<code>Cage&lt;Animal&gt;</code>è¯»å–ï¼Œä»»ä½•æ—¶å€™éƒ½ä¸ä¼šå‡ºé”™ï¼›å¦‚æœç±»å‹<strong>åªå†™</strong>ï¼Œé‚£ä¹ˆå‡½æ•°ä¸­çš„æ“ä½œåªèƒ½å¯¹å®¹å™¨å†…å®¹è¿›è¡Œå†™å…¥æˆ–è€…ä»€ä¹ˆéƒ½ä¸åšï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è€ƒè™‘é€†å˜ï¼Œå³<code>Cage&lt;Animal&gt;</code>æ˜¯<code>Cage&lt;Dog&gt;</code>çš„å­ç±»å‹ï¼Œå¯¹äºä»»ä½•éœ€è¦<code>Cage&lt;Dog&gt;</code>çš„å‡½æ•°ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ä¼ å…¥<code>Cage&lt;Animal&gt;</code>ï¼Œå‡½æ•°åªä¼šå‘å…¶ä¸­å†™å…¥ä¸€åª<code>Dog</code>ï¼Œè€Œä¸å…³å¿ƒåŸæ¥æ˜¯ä»€ä¹ˆï¼Œå¹¶ä¸”ç¨‹åºä¹Ÿæ°¸è¿œä¹Ÿä¸ä¼šå»è¯»<code>Cage</code>é‡Œçš„ä¸œè¥¿ï¼Œç¨‹åºè¯­è¨€ä¸­ï¼Œé€†å˜åŸºæœ¬ä¸å‡ºç°ï¼›å¦‚æœç±»å‹å¯è¯»å¯å†™ï¼Œé‚£ä¹ˆåªèƒ½æ˜¯æŠ—å˜ï¼Œè¦æ±‚ç±»å‹ä¸¥æ ¼ä¸€è‡´æ¥ä¿è¯ç±»å‹å®‰å…¨ã€‚</p>
<p>ç±»å‹æ„é€ å™¨å¯¼è‡´é€†å˜çš„æƒ…å†µéå¸¸å°‘ï¼Œä¸»è¦å‡ºç°åœ¨ä»¥å‡½æ•°ä½œä¸ºç±»å‹æ„é€ å™¨æ—¶ï¼š</p>
<p>$$<br>F(U) \rightarrow V<br>$$</p>
<p>å¦‚ä¸Šçš„ä¸€å…ƒå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ª<code>U</code>ç±»å‹çš„å‚æ•°ï¼Œè¿”å›ä¸€ä¸ª<code>V</code>ç±»å‹çš„å€¼ã€‚å¦‚æœæœ‰<code>U &lt;: T</code>ï¼Œé‚£ä¹ˆä»»ä½•éœ€è¦$F(U) \rightarrow V$çš„åœ°æ–¹ï¼Œå¯ä»¥ä½¿ç”¨$F(T) \rightarrow V$ä»£æ›¿ï¼Œè¿™å¾ˆç›´è§‚ï¼Œå› ä¸º<code>U</code>æ˜¯<code>T</code>çš„å­ç±»å‹ï¼Œæ‰€ä»¥ä¸€ä¸ªèƒ½å¤„ç† T ç±»å‹çš„å‡½æ•°å¿…ç„¶èƒ½å¤„ç† U ç±»å‹ï¼Œä¾‹å¦‚ä¸€ä¸ªèƒ½è®¡ç®—<code>Animal</code>å¹´é¾„çš„å‡½æ•°ä¸€å®šä¹Ÿèƒ½è®¡ç®—<code>Cat</code>çš„å¹´é¾„ï¼Œæ‰€ä»¥æœ‰ï¼š</p>
<p>$$<br>U &lt;: T \Rightarrow F(T) \rightarrow V &lt;: F(U) \rightarrow V<br>$$</p>
<p>å³æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªä½œç”¨åŸŸè¾ƒå¤§çš„å‡½æ•°ä»£æ›¿ä¸€ä¸ªä½œç”¨åŸŸè¾ƒå°çš„å‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åœ¨ä½¿ç”¨æ—¶å®‰å…¨åœ°æ”¶ç¼©å®ƒçš„ä½œç”¨åŸŸè‡³å’Œåè€…ä¸€æ ·ï¼Œå³åªä½¿ç”¨<code>Animal</code>ä¸­å±äº<code>Cat</code>çš„é‚£ä¸€éƒ¨åˆ†ã€‚</p>
<h1 id="Rust-ç”Ÿå‘½å‘¨æœŸ"><a href="#Rust-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Rust ç”Ÿå‘½å‘¨æœŸ"></a>Rust ç”Ÿå‘½å‘¨æœŸ</h1><p>Rust æ²¡æœ‰ç±»å‹ç»§æ‰¿ï¼Œä½†æ˜¯ Rust æœ‰ lifetime å•Šï¼Œæ‰€ä»¥ Rust çš„å­ç±»å‹å¿…å®šæ˜¯æŒ‡ lifetime ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p>åœ¨ Rust ä¸­ï¼Œ<code>&#39;a:&#39;b</code>æ„æ€æ˜¯<code>&#39;a</code> <strong>outlives</strong> <code>&#39;b</code>ï¼Œå³<code>&#39;a</code>è¡¨ç¤ºçš„ç”Ÿå‘½å‘¨æœŸå¤§äºç­‰äº<code>&#39;b</code>ï¼Œä¹Ÿä»£è¡¨ç€<code>&#39;a &lt;: &#39;b</code>ã€‚ä¹ä¸€çœ‹æœ‰ç‚¹åç›´è§‰ï¼Œä½†ä¹Ÿå¾ˆå¥½ç†è§£ã€‚<code>&#39;a:&#39;b</code>ä»£è¡¨<code>&#39;a</code>è‡³å°‘å’Œ<code>&#39;b</code>ä¸€æ ·é•¿ï¼Œå³<code>&#39;a</code>æ¯”<code>&#39;b</code>æ›´åŠ ç‰¹åŒ–ï¼Œå°±åƒ<code>Cat</code>è‡³å°‘æ˜¯ç§<code>Animal</code>ï¼Œ<code>Cat</code>æ›´åŠ ç‰¹åŒ–ã€‚<code>&#39;static</code>å…³é”®å­—ä»£è¡¨é™æ€ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨ç¨‹åºçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­æŒç»­å­˜åœ¨ï¼Œæ‰€ä»¥<code>&#39;static</code>æ˜¯ä»»æ„ç”Ÿå‘½å‘¨æœŸ<code>&#39;a</code>çš„å­ç±»å‹ã€‚</p>
<p>æˆ‘ä»¬ç»å¸¸ä¼šæ„Ÿå¹äº Rust ç¼–è¯‘å™¨çš„æ™ºèƒ½ï¼Œèƒ½å‡†ç¡®æ¨æ–­å‡ºç¨‹åºä¸­æŸä¸ªå¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸä¸å¤Ÿé•¿ã€ä¸åŒ¹é…ã€‚è¿™åŒæ—¶ä¹Ÿæ˜¯å­ç±»å‹å’Œå˜å½¢çš„åŠŸåŠ³ã€‚æ ¹æ®ä¸Šæ–‡è®¨è®ºçš„ç»“è®ºï¼ŒRust ç”Ÿå‘½å‘¨æœŸçš„å­ç±»å‹æœ‰å¦‚ä¸‹å˜å½¢è§„åˆ™ï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th>â€˜a</th>
<th>T</th>
<th>U</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td><code>&amp;&#39;a T </code></td>
<td>covariant</td>
<td>covariant</td>
<td></td>
</tr>
<tr>
<td>*</td>
<td><code>&amp;&#39;a mut T</code></td>
<td>covariant</td>
<td>invariant</td>
<td></td>
</tr>
<tr>
<td>*</td>
<td><code>Box&lt;T&gt;</code></td>
<td></td>
<td>covariant</td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>Vec&lt;T&gt;</code></td>
<td></td>
<td>covariant</td>
<td></td>
</tr>
<tr>
<td>*</td>
<td><code>UnsafeCell&lt;T&gt;</code></td>
<td></td>
<td>invariant</td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>Cell&lt;T&gt;</code></td>
<td></td>
<td>invariant</td>
<td></td>
</tr>
<tr>
<td>*</td>
<td><code>fn(T) -&gt; U</code></td>
<td></td>
<td><strong>contra</strong>variant</td>
<td>covariant</td>
</tr>
<tr>
<td></td>
<td><code>*const T</code></td>
<td></td>
<td>covariant</td>
<td></td>
</tr>
<tr>
<td></td>
<td><code>*mut T</code></td>
<td></td>
<td>invariant</td>
<td></td>
</tr>
</tbody></table>
<p>æˆ‘ä»¬çœ‹å¦‚ä¸‹è¿™ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">evil_feeder</span></span>&lt;T&gt;(input: &amp;<span class="keyword">mut</span> T, val: T) &#123;</span><br><span class="line">    *input = val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> mr_snuggles: &amp;<span class="symbol">&#x27;static</span> <span class="built_in">str</span> = <span class="string">&quot;meow! :3&quot;</span>; <span class="comment">// mr. snuggles forever!!</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> spike = <span class="built_in">String</span>::from(<span class="string">&quot;bark! &gt;:V&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> spike_str: &amp;<span class="built_in">str</span> = &amp;spike; <span class="comment">// Only lives for the block</span></span><br><span class="line">        evil_feeder(&amp;<span class="keyword">mut</span> mr_snuggles, spike_str); <span class="comment">// EVIL!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, mr_snuggles); <span class="comment">// Use after free?</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–è¯‘ç»“æœï¼š</p>
<p><img src="image-20210408013314451.png" alt="image-20210408013314451"></p>
<p>æˆ‘ä»¬ä¸€çœ¼å°±èƒ½çœ‹å‡ºï¼Œ<code>spike_str</code>çš„ lifetime å¤ªçŸ­äº†ï¼Œä¸å¯èƒ½å¤åˆ¶ç»™<code>mr_snuggles</code>ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨æ˜¯å¦‚ä½•æ¨æ–­çš„å‘¢ï¼Ÿ</p>
<ul>
<li>å› ä¸º<code>&amp;mut T</code>æ˜¯å¯¹ T çš„ invariantï¼Œæ‰€ä»¥ç¼–è¯‘å™¨æ¨æ–­ T å¿…é¡»æ˜¯<code>&amp;&#39;static str</code>ï¼›</li>
<li><code>spike_str</code>æ˜¯ä¸€ä¸ª<code>&amp;&#39;a str</code>ï¼Œå¯¹<code>&#39;a</code>æ˜¯ covariantï¼Œè¦åŒ¹é… Tï¼Œå¿…é¡»å°è¯•é€šè¿‡ covariant å˜å½¢æˆ<code>&#39;static str</code>ï¼›</li>
<li>é‚£ä¹ˆç¼–è¯‘å™¨æ¨æ–­å‡º<code>&amp;&#39;a str:&#39;&amp;&#39;static str</code>ï¼Œä¹Ÿå³<code>&#39;a:&#39;static</code>ï¼Œè¿™å½“ç„¶æ— æ³•æˆç«‹ï¼Œå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚</li>
</ul>
<p>æ­¤å¤–ï¼Œå†çœ‹ä¸€ä¸ªæ›´æ˜æ˜¾çš„ä¾‹å­:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// compile error</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">invariant</span></span>&lt;<span class="symbol">&#x27;a</span>: <span class="symbol">&#x27;b</span>, <span class="symbol">&#x27;b</span>, <span class="symbol">&#x27;c</span>&gt;(</span><br><span class="line">    sub: &amp;<span class="symbol">&#x27;c</span> <span class="keyword">mut</span> <span class="built_in">Vec</span>&lt;&amp;<span class="symbol">&#x27;a</span> <span class="built_in">String</span>&gt;,</span><br><span class="line">    sup: &amp;<span class="symbol">&#x27;c</span> <span class="keyword">mut</span> <span class="built_in">Vec</span>&lt;&amp;<span class="symbol">&#x27;b</span> <span class="built_in">String</span>&gt;,</span><br><span class="line">) -&gt; &amp;<span class="symbol">&#x27;c</span> <span class="keyword">mut</span> <span class="built_in">Vec</span>&lt;&amp;<span class="symbol">&#x27;b</span> <span class="built_in">String</span>&gt; &#123;</span><br><span class="line">    sub</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// compile ok</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">covariant</span></span>&lt;<span class="symbol">&#x27;a</span>: <span class="symbol">&#x27;b</span>, <span class="symbol">&#x27;b</span>, <span class="symbol">&#x27;c</span>&gt;(</span><br><span class="line">    sub: &amp;<span class="symbol">&#x27;c</span> <span class="built_in">Vec</span>&lt;&amp;<span class="symbol">&#x27;a</span> <span class="built_in">String</span>&gt;,</span><br><span class="line">    sup: &amp;<span class="symbol">&#x27;c</span> <span class="built_in">Vec</span>&lt;&amp;<span class="symbol">&#x27;b</span> <span class="built_in">String</span>&gt;,</span><br><span class="line">) -&gt; &amp;<span class="symbol">&#x27;c</span> <span class="built_in">Vec</span>&lt;&amp;<span class="symbol">&#x27;b</span> <span class="built_in">String</span>&gt; &#123;</span><br><span class="line">    sub</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>build ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="image-20210408014252451.png" alt="image-20210408014252451"></p>
<ul>
<li>åœ¨ä¸¤ä¸ªå‡½æ•°çš„æ³›å‹å‚æ•°ä¸­ï¼Œæ˜¾å¼æ ‡æ³¨äº†<code>&#39;a : &#39;b</code>ï¼›</li>
<li>ç”±äº<code>&amp;&#39;a T</code>å¯¹<code>&#39;a</code> covariantï¼Œæ‰€ä»¥<code>&amp;&#39;a String : &amp;&#39;b String</code>ï¼›</li>
<li>ç”±äº<code>Vec&lt;T&gt;</code>å¯¹<code>T</code> covariantï¼Œæ‰€ä»¥<code>Vec&lt;&amp;&#39;a String&gt; : Vec&lt;&amp;&#39;b String&gt;</code>ï¼›</li>
<li>ç”±äº<code>&amp;&#39;a T</code>å¯¹ T æ˜¯ covariantï¼Œæ‰€ä»¥<code>&amp;&#39;c Vec&lt;&amp;&#39;a String&gt; : &amp;&#39;c Vec&lt;&amp;&#39;b String&gt;</code>ï¼›</li>
<li>æ‰€ä»¥åœ¨ covariant å‡½æ•°ä¸­ï¼Œå½“å‡½æ•°è¦æ±‚è¿”å›<code>&amp;&#39;c Vec&lt;&amp;&#39;b String&gt;</code>æ—¶ï¼Œå¯ä»¥ç›´æ¥è¿”å›<code>&amp;&#39;c Vec&lt;&amp;&#39;a String&gt;</code>ï¼›</li>
<li>ä½†æ˜¯<code>&amp;&#39;c mut T</code>å¯¹ T æ˜¯ invariantï¼Œ<code>&amp;&#39;c mut Vec&lt;&amp;&#39;a String&gt;</code>ä¸``&amp;â€™c mut Vec&lt;&amp;â€™b String&gt;`é—´æ²¡æœ‰å­ç±»å‹å…³ç³»ï¼Œæ‰€ä»¥åœ¨ invariant å‡½æ•°ä¸­æ— æ³•å†è¿™ä¹ˆåšã€‚</li>
</ul>
<p>æœ€åè¿˜æœ‰ä¸€ä¸ªä¾‹å­ï¼Œçœ‹çœ‹å‡½æ•°çš„é€†å˜ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ContraVariant</span></span>&lt;Mixed&gt; &#123;</span><br><span class="line">    f: <span class="function"><span class="keyword">fn</span></span>(Mixed),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">test</span></span>&lt;<span class="symbol">&#x27;a</span>&gt;(</span><br><span class="line">    a: &amp;<span class="keyword">mut</span> ContraVariant&lt;&amp;<span class="symbol">&#x27;a</span> <span class="built_in">i32</span>&gt;,</span><br><span class="line">    b: &amp;<span class="keyword">mut</span> ContraVariant&lt;&amp;<span class="symbol">&#x27;static</span> <span class="built_in">i32</span>&gt;,</span><br><span class="line">    f1: <span class="function"><span class="keyword">fn</span></span>(&amp;<span class="symbol">&#x27;a</span> <span class="built_in">i32</span>),</span><br><span class="line">    f2: <span class="function"><span class="keyword">fn</span></span>(&amp;<span class="symbol">&#x27;static</span> <span class="built_in">i32</span>),</span><br><span class="line">) &#123;</span><br><span class="line">    a.f = f1;</span><br><span class="line">    a.f = f2;</span><br><span class="line">    b.f = f1;</span><br><span class="line">    b.f = f2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>build ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="image-20210428235350226.png" alt="image-20210428235350226"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå››ä¸ªèµ‹å€¼è¯­å¥ä¸­ï¼Œåªæœ‰<code>a.f = f2</code>å¤±è´¥äº†ã€‚</p>
<ul>
<li><code>fn(T)</code>å¯¹<code>T</code> <strong>contra</strong>variantï¼Œ<code>&amp;&#39;static i32 : &amp;&#39;a i32</code>ï¼Œæ‰€ä»¥ <code>fn(&amp;&#39;a i32) : fn(&amp;&#39;static i32)</code>ï¼›</li>
<li><code>a.f</code>ç±»å‹ä¸º<code>fn(&amp;&#39;a i32)</code>ï¼Œ<code>f2</code>ç±»å‹ä¸º<code>fn(&amp;&#39;static i32)</code>ï¼›</li>
<li><code>a.f = f2</code>ï¼Œç›¸å½“äºæŠŠçˆ¶ç±»å‹å˜é‡èµ‹å€¼ç»™äº†å­ç±»å‹ï¼Œç±»å‹ä¸åŒ¹é…ï¼Œå¤±è´¥äº†ã€‚</li>
</ul>
<h1 id="èµ„æ–™æ´å¼•"><a href="#èµ„æ–™æ´å¼•" class="headerlink" title="èµ„æ–™æ´å¼•"></a>èµ„æ–™æ´å¼•</h1><ul>
<li><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/nomicon/subtyping.html">https://doc.rust-lang.org/nomicon/subtyping.html</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Type_constructor">https://en.wikipedia.org/wiki/Type_constructor</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Subtyping">https://en.wikipedia.org/wiki/Subtyping</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)">https://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/41814387">https://zhuanlan.zhihu.com/p/41814387</a></li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>Rustç”Ÿå‘½å‘¨æœŸä¸å˜å½¢</p><p><a href="https://wmc1999.top/2021/04/29/rust-lifetime-variance/">https://wmc1999.top/2021/04/29/rust-lifetime-variance/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>ä½œè€…</h6><p>Naruto210</p></div></div><div class="level-item is-narrow"><div><h6>å‘å¸ƒäº</h6><p>2021-04-29</p></div></div><div class="level-item is-narrow"><div><h6>æ›´æ–°äº</h6><p>2021-12-22</p></div></div><div class="level-item is-narrow"><div><h6>è®¸å¯åè®®</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/rust/">rust</a><a class="link-muted mr-2" rel="tag" href="/tags/variance/">variance</a><a class="link-muted mr-2" rel="tag" href="/tags/subtype/">subtype</a></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_telegram"></a><a class="a2a_button_whatsapp"></a><a class="a2a_button_reddit"></a></div><script src="https://static.addtoany.com/menu/page.js" defer></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/03/03/6-S081-lab10-mmap/"><span class="level-item">6.S081 lab10 mmap</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">è¯„è®º</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://wmc1999.top/2021/04/29/rust-lifetime-variance/';
            this.page.identifier = '2021/04/29/rust-lifetime-variance/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'wmc1999' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/avatar.jpeg" alt="Naruto210"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Naruto210</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Beijing</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">22</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories"><p class="title">10</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags"><p class="title">31</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/waruto210" target="_blank" rel="noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/waruto210"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/Json210314"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/rss.xml"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">é“¾æ¥</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://rinchannowww.github.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">å“²å®‡é…±</span></span><span class="level-right"><span class="level-item tag">rinchannowww.github.io</span></span></a></li><li><a class="level is-mobile" href="https://ipotato.me/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">è€¿æ€»</span></span><span class="level-right"><span class="level-item tag">ipotato.me</span></span></a></li><li><a class="level is-mobile" href="https://qjx.app/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Qå“¥</span></span><span class="level-right"><span class="level-item tag">qjx.app</span></span></a></li><li><a class="level is-mobile" href="https://sprinter1999.github.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">å­¦åˆ†</span></span><span class="level-right"><span class="level-item tag">sprinter1999.github.io</span></span></a></li><li><a class="level is-mobile" href="https://blog.name1e5s.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">ğŸŸå¤§ä½¬</span></span><span class="level-right"><span class="level-item tag">blog.name1e5s.com</span></span></a></li><li><a class="level is-mobile" href="https://columbine21.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">è¢å·¨å·¨</span></span><span class="level-right"><span class="level-item tag">columbine21.github.io</span></span></a></li><li><a class="level is-mobile" href="https://leiblog.wang" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">LeiWang1999</span></span><span class="level-right"><span class="level-item tag">leiblog.wang</span></span></a></li></ul></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/logo.jpeg" alt="OneStep" height="28"></a><p class="is-size-7"><span>&copy; 2021 Naruto210</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">å…±<span id="busuanzi_value_site_uv">0</span>ä¸ªè®¿å®¢</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script></body></html>